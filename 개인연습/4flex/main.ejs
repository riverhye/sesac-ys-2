<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieCaster - Main</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <link rel="stylesheet" href="../static/css/main.css" />
    <link rel="stylesheet" href="../static/css/header.css" />
    <link rel="stylesheet" href="../static/css/footer.css" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
</head>
<body>
    <header>
        <section class="logo-section">
            <div class="logo" onclick="location.href='/'"><img src="/static/img/logo.png" alt="logo" width="150px" height="100px"/></div>
            <div class="icon-group">
                <a href="/search"><i class="fa-solid fa-magnifying-glass search-icon"></i></a>
                <a href="/signin"><i class="fa-solid fa-user user-icon"></i></a>
            </div>
        </section>

        <section class="box-office-section">
            <div class="box-office__film">
                <img src="../static/img/filmroll.jpg" alt="" width="1500px" height="280px"/>
                <span class="box-office-text">Box Office</span>
                <ul class="box-office-slider">
                    <li class="box-office-poster"><img href="" src="" /></li>
                    <li class="box-office-poster"><img href="" src="" /></li>
                    <li class="box-office-poster"><img href="" src="" /></li>
                    <li class="box-office-poster"><img href="" src="" /></li>
                    <li class="box-office-poster"><img href="" src="" /></li>
                </ul>
            </div>
        </section>
    </header>

    <div class="main-section">
        <section class="best-section">
            <div class="best-section__title section__title">
                <i class="bi bi-brightness-high sun-icon"></i>
                <h4>해가 쨍쨍! 평점 높은 영화</h4>
            </div>
            <div class="swiper best-swiper">
                <div class="swiper-wrapper best-movie__list section__list">
                    <div class="swiper-slide best-movie__body section__body">
                        <div class="best-movie__poster-body section__poster-body">
                            <ul>
                                <li><a href="">
                                    <div class="best-movie__poster"><img src="" alt="" /></div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="best-movie__comment-list">
                            <ul>
                                <li class="text-sm">
                                    <span class="nickname-sm">유저닉네임</span>
                                    <i class="fa-solid fa-heart heart-icon" onclick="clickLike(this)"></i>
                                </li>
                                <li class="movie-title text-sm"><strong><span>헝거게임 : 노래하는 어쩌고와 저쩌고</span></strong></li>
                                <li class="comment-sm text-sm"><span>개봉을 기다리는 영화인데 내년으로 미뤄진다고...</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="swiper-slide best-movie__body section__body">
                        <div class="best-movie__poster-body section__poster-body">
                            <ul>
                                <li><a href="">
                                    <div class="best-movie__poster"><img src="" alt="" /></div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="best-movie__comment-list">
                            <ul>
                                <li class="text-sm">
                                    <span class="nickname-sm">유저닉네임</span>
                                    <i class="fa-solid fa-heart heart-icon" onclick="clickLike(this)"></i>
                                </li>
                                <li class="movie-title text-sm"><strong><span>헝거게임 : 노래하는 어쩌고와 저쩌고</span></strong></li>
                                <li class="comment-sm text-sm"><span>개봉을 기다리는 영화인데 내년으로 미뤄진다고...</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="swiper-slide best-movie__body section__body">
                        <div class="best-movie__poster-body section__poster-body">
                            <ul>
                                <li><a href="">
                                    <div class="best-movie__poster"><img src="" alt="" /></div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="best-movie__comment-list">
                            <ul>
                                <li class="text-sm">
                                    <span class="nickname-sm">유저닉네임</span>
                                    <i class="fa-solid fa-heart heart-icon" onclick="clickLike(this)"></i>
                                </li>
                                <li class="movie-title text-sm"><strong><span>헝거게임 : 노래하는 어쩌고와 저쩌고</span></strong></li>
                                <li class="comment-sm text-sm"><span>개봉을 기다리는 영화인데 내년으로 미뤄진다고...</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="swiper-slide best-movie__body section__body">
                        <div class="best-movie__poster-body section__poster-body">
                            <ul>
                                <li><a href="">
                                    <div class="best-movie__poster"><img src="" alt="" /></div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="best-movie__comment-list">
                            <ul>
                                <li class="text-sm">
                                    <span class="nickname-sm">유저닉네임</span>
                                    <i class="fa-solid fa-heart heart-icon" onclick="clickLike(this)"></i>
                                </li>
                                <li class="movie-title text-sm"><strong><span>헝거게임 : 노래하는 어쩌고와 저쩌고</span></strong></li>
                                <li class="comment-sm text-sm"><span>개봉을 기다리는 영화인데 내년으로 미뤄진다고...</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="swiper-slide best-movie__body section__body">
                        <div class="best-movie__poster-body section__poster-body">
                            <ul>
                                <li><a href="">
                                    <div class="best-movie__poster"><img src="" alt="" /></div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="best-movie__comment-list">
                            <ul>
                                <li class="text-sm">
                                    <span class="nickname-sm">유저닉네임</span>
                                    <i class="fa-solid fa-heart heart-icon" onclick="clickLike(this)"></i>
                                </li>
                                <li class="movie-title text-sm"><strong><span>헝거게임 : 노래하는 어쩌고와 저쩌고</span></strong></li>
                                <li class="comment-sm text-sm"><span>개봉을 기다리는 영화인데 내년으로 미뤄진다고...</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="swiper-slide best-movie__body section__body">
                        <div class="best-movie__poster-body section__poster-body">
                            <ul>
                                <li><a href="">
                                    <div class="best-movie__poster"><img src="" alt="" /></div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="best-movie__comment-list">
                            <ul>
                                <li class="text-sm">
                                    <span class="nickname-sm">유저닉네임</span>
                                    <i class="fa-solid fa-heart heart-icon" onclick="clickLike(this)"></i>
                                </li>
                                <li class="movie-title text-sm"><strong><span>헝거게임 : 노래하는 어쩌고와 저쩌고</span></strong></li>
                                <li class="comment-sm text-sm"><span>개봉을 기다리는 영화인데 내년으로 미뤄진다고...</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="swiper-slide best-movie__body section__body">
                        <div class="best-movie__poster-body section__poster-body">
                            <ul>
                                <li><a href="">
                                    <div class="best-movie__poster"><img src="" alt="" /></div>
                                </a></li>
                            </ul>
                        </div>
                        <div class="best-movie__comment-list">
                            <ul>
                                <li class="text-sm">
                                    <span class="nickname-sm">유저닉네임</span>
                                    <i class="fa-solid fa-heart heart-icon" onclick="clickLike(this)"></i>
                                </li>
                                <li class="movie-title text-sm"><strong><span>헝거게임 : 노래하는 어쩌고와 저쩌고</span></strong></li>
                                <li class="comment-sm text-sm"><span>개봉을 기다리는 영화인데 내년으로 미뤄진다고...</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="arrow-box swiper-button-prev"><i class="fa-solid fa-chevron-left arrow-icon left-arrow"></i></div>
                <div class="arrow-box swiper-button-next"><i class="fa-solid fa-chevron-right arrow-icon right-arrow"></i></div>
            </div>
        </section>

        <section class="md-section">
            <div class="md-section__title section__title">
                <i class="bi bi-brightness-high sun-icon"></i>
                <i class="fa-solid fa-cloud cloud-icon"></i>
                <h4>개봉 예정 영화</h4>
            </div>
            <div class="md-movie__list section__list">
                <div class="md-movie__body section__body">
                    <div class="md-movie__poster-body section__poster-body">
                        <ul>
                            <li><a href="">
                                <div class="md-movie__poster"><img src="" alt="" /></div>
                            </a></li>
                        </ul>
                    </div>
                    <div class="md-movie__info">
                        <ul>
                            <li class="md-movie__rating">
                                <i class="bi bi-brightness-high"></i>
                                <span class="">5.0</span>
                            </li>
                            <li><h4 class="movie-title__large">타이틀</h4></li>
                        </ul>
                    </div>
                </div>
                <div class="md-movie__body section__body">
                    <div class="md-movie__poster-body section__poster-body">
                        <ul>
                            <li><a href="">
                                <div class="md-movie__poster"><img src="" alt="" /></div>
                            </a></li>
                        </ul>
                    </div>
                    <div class="md-movie__info">
                        <ul>
                            <li class="md-movie__rating">
                                <i class="bi bi-brightness-high"></i>
                                <span class="">5.0</span>
                            </li>
                            <li><h4 class="movie-title__large">타이틀</h4></li>
                        </ul>
                    </div>
                </div>
                <div class="md-movie__body section__body">
                    <div class="md-movie__poster-body section__poster-body">
                        <ul>
                            <li><a href="">
                                <div class="md-movie__poster"><img src="" alt="" /></div>
                            </a></li>
                        </ul>
                    </div>
                    <div class="md-movie__info">
                        <ul>
                            <li class="md-movie__rating">
                                <i class="bi bi-brightness-high"></i>
                                <span class="">5.0</span>
                            </li>
                            <li><h4 class="movie-title__large">타이틀</h4></li>
                        </ul>
                    </div>
                </div>
                <div class="md-movie__body section__body">
                    <div class="md-movie__poster-body section__poster-body">
                        <ul>
                            <li><a href="">
                                <div class="md-movie__poster"><img src="" alt="" /></div>
                            </a></li>
                        </ul>
                    </div>
                    <div class="md-movie__info">
                        <ul>
                            <li class="md-movie__rating">
                                <i class="bi bi-brightness-high"></i>
                                <span class="">5.0</span>
                            </li>
                            <li><h4 class="movie-title__large">타이틀</h4></li>
                        </ul>
                    </div>
                </div>
                <div class="md-movie__body section__body">
                    <div class="md-movie__poster-body section__poster-body">
                        <ul>
                            <li><a href="">
                                <div class="md-movie__poster"><img src="" alt="" /></div>
                            </a></li>
                        </ul>
                    </div>
                    <div class="md-movie__info">
                        <ul>
                            <li class="md-movie__rating">
                                <i class="bi bi-brightness-high"></i>
                                <span class="">5.0</span>
                            </li>
                            <li><h4 class="movie-title__large">타이틀</h4></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="arrow-box"><i class="fa-solid fa-chevron-left arrow-icon left-arrow"></i></div>
            <div class="arrow-box"><i class="fa-solid fa-chevron-right arrow-icon right-arrow"></i></div>
        </section>
    </div>
    <!-- footer -->
    <div class="footer">
        <strong>주식회사</strong> 무비캐스터 <strong>대표</strong> 4FLEX 
        서울특별시 용산구 청파로 109(나진전자월드상가) 3층 <br />
        <strong>사업자 등록 번호</strong> 595-95-0099 <br/>
        © 2023 by MovieCaster, Inc. All rights reserved. <br/>
    </div>

    <script>
        function clickLike (thisIcon) {
            thisIcon.classList.toggle('heart-active')
        }

        // api key 받아오기
        let key = '';
        axios({
            method: 'post',
            url: '/'
        }).then((res) => {
            key = res.data
            // console.log(key);

            // box office api 받아오기
            const endpoint = 'https://api.themoviedb.org/3/movie';
            axios
            .get(`${endpoint}/now_playing?api_key=${key}&language=ko-KR`)
            .then((res) => {
                const movieData = res.data.results.slice(0,9);
                let posterPath = [];
                movieData.map(movie => {
                    posterPath.push(movie.poster_path);
                });
                // console.log("posterPath", posterPath);
    
                const boxOfficePosters = document.querySelectorAll('.box-office-poster img');
                // console.log("img 전체 선택", boxOfficePosters)
                // typeof boxOfficePosters : Object
                boxOfficePosters.forEach((poster, index) => {
                    poster.src = `https://image.tmdb.org/t/p/w154/${posterPath[index]}`
                });
            });

            axios
            .get(`${endpoint}/top_rated?api_key=${key}&language=ko-KR`)
            .then((res) => {
                const movieData = res.data.results.slice(0,9);
                let posterPath = [];
                movieData.map(movie => {
                    posterPath.push(movie.poster_path);
                }) 
                // console.log("posterPath", posterPath);
                // console.log("posterTitle", title);
    
                const bestMoviePosters = document.querySelectorAll('.best-movie__poster img')
                // console.log("img 전체 선택", bestMoviePosters)
                // typeof bestMoviePosters : Object
                bestMoviePosters.forEach((poster, index) => {
                    poster.src = `https://image.tmdb.org/t/p/w200/${posterPath[index]}`
                });
            });

            axios
            .get(`${endpoint}/upcoming?api_key=${key}&language=ko-KR`)
            .then((res) => {
                const movieData = res.data.results.slice(2,11)
                let posterPath = [];
                let posterTitle = [];
                movieData.map(movie => {
                    posterPath.push(movie.poster_path);
                    posterTitle.push(movie.title);
                });

                const mdMoivePosters = document.querySelectorAll('.md-movie__poster img')

                mdMoivePosters.forEach((poster, index) => {
                    poster.src = `https://image.tmdb.org/t/p/w200/${posterPath[index]}`
                });

                const upcomingMovies = document.querySelectorAll('.movie-title__large');
                upcomingMovies.forEach((title, index) => {
                    title.textContent = `${posterTitle[index]}`
                });
            });
        });
    </script>

    <script>
        const swiper = new Swiper('.best-swiper', {
            loop: true,
            slidePerView: 5,
            slidePerGroup: 1,
            navigation: {
                prevEl: '.swiper-button-prev',
                nextEl: '.swiper-button-next'
            }
        });
    </script>
</body>
</html>